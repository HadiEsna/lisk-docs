= Update Lisk Core (NPM)
Mona Bärenfänger <mona@lightcurve.io>
:description: How to update Lisk Core to the latest version (Binary).
:toc:
:sectnums:
:experimental:
// Project URLs
:url_enable_forging: management/forging.adoc

== Check for new versions

[source,bash]
----
npm outdated --global --depth=0
----

[source,bash]
----
Package    Current   Wanted  Latest  Location
lisk-core    3.0.2    3.0.4   3.0.4  global
----

As the output indicates, we currently have v3.0.2 installed, but the latest version of Lisk Core is `v3.0.4`.

== Stop Lisk Core

[source,bash]
----
pm2 delete lisk-core
----

== Backup Lisk Core

[source,bash]
----
tar czf ~/backup_lisk.tar.gz ~/.lisk/lisk-core
----

== Install the new version

IMPORTANT: In case a custom config file is used with Lisk Core, copy one of the default config files of the new Lisk Core version to use it as a basis for the new custom config, and adjust it according to your old custom config.

[source,bash]
----
npm update --global lisk-core
----

== Start Lisk Core

[source,bash]
----
pm2 start pm2.conf.json
----

== Sanity Check

Verify the correct version.

[source,bash]
----
lisk-core --version
#lisk-core/3.0.4 linux-x64 node-v16.15.0
----

Check if the new `transferFixHeight, serializationFixHeight` is correctly set:

* `transferFixHeight, serializationFixHeight` value for the Mainnet is `17557156`.
* `transferFixHeight, serializationFixHeight` value for the Testnet is `15466999`.

.Example: Checking `transferFixHeight, serializationFixHeight` for Testnet
[source,bash]
----
lisk-core node:info --pretty | grep "serializationFixHeight\|transferFixHeight"
"transferFixHeight, serializationFixHeight": 15466999
----

.For delegates
NOTE: *For delegates:* Don't forget that xref:{url_enable_forging}[] again is required after the update.

